<?php
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     enterprise_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
?>
<div class="footer-container">
	<div class="footer">
		<div class="f-nav"><?php echo $this->getChildHtml() ?></div>
	</div>
</div>
<div class="bottom-panel">
	<div class="social-links">
		<?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('footer-social-links')->toHtml() ?>
	</div>
	<div class="facebook-like-footer">
		<iframe
			src="https://www.facebook.com/plugins/like.php?app_id=195380167187861&amp;href=http%3A%2F%2Fwww.facebook.com%2Fkatesomervilleskincare&amp;send=false&amp;layout=button_count&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=30"
			scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:85px; height:30px;margin-top:5px" allowTransparency="true"></iframe>
	</div>

	&copy; <?php echo date("Y") ?> <?php echo $this->getCopyright() ?>
	<ul class="links">
		<?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('footer-after-links')->toHtml() ?>
	</ul>
</div>
<?php $lightbox_block = new Alliance_EmailCapture_Block_Lightbox; ?>
<style>
	#email-newsletter-lightbox-container {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		padding: 0;
		margin: 0;
		width: 100%;
		height: 100%;
		background: rgba(0, 0, 0, 0.5);
		z-index: 999;
	}

	#email-newsletter-lightbox-thankyou {
		width: <?php echo $lightbox_block->getThankyouWidth(); ?>px;
		height: <?php echo $lightbox_block->getThankyouHeight(); ?>px;
		margin: auto;
		position: absolute;
		top: 0;
		left: 0;
		bottom: 0;
		right: 0;
		background-image: url('<?php echo $lightbox_block->getThankyouImageUrl(); ?>');
		background-size: <?php echo $lightbox_block->getThankyouWidth(); ?>px <?php echo $this->getThankyouHeight(); ?>px;
	}

	.email-newsletter-close {
		height: 24px;
		position: absolute;
		top: 0;
		right: 0;
		color: white;
		background-color: #75b8db;
		width: 100%;
		float: right;
		cursor: pointer;
	}

	.email-newsletter-close span {
		float: right;
		border: 1px solid white;
		line-height: 14px;
		height: 14px;
		font-size: 13px;
		padding: 0 2px;
		margin: 4px 6px;
	}

	.email-newsletter-close:after {
		content: "CLOSE";
		line-height: 26px;
		float: right;
		font-size: 13px;
	}

	.email-newsletter-continue {
		line-height: 32px;
		font-size: 16px;
		margin: 0 auto;
		cursor: pointer;
		color: white !important;
		background-color: #75b8db;
		text-align: center;
		position: absolute;
		bottom: 20px;
		right: 170px;
		padding: 0 10px;
	}

	.email-newsletter-coupon-code {
		position: absolute;
		bottom: 132px;
		right: 137px;
		font-size: 14px;
		color: #FFF;
		background-color: orange;
		width: 100px;
		text-align: center;
		height: 20px;
		line-height: 20px;
	}

	.email-newsletter-continue:hover {
		text-decoration: none;
		color: white !important;
	}

	.email-newsletter-disclaimer {
		position: absolute;
		bottom: 74px;
		right: 50px;
		width: 295px;
		font-size: 11px;
		color: gray;
	}

</style>

<div id="email-newsletter-lightbox-container" style="display: none;">
	<div id="email-newsletter-lightbox-thankyou">
		<div class="email-newsletter-close"><span>X</span></div>
		<div class="email-newsletter-thankyou-bottom">
			<span>
				<a class="email-newsletter-continue"
				   href="<?php echo $lightbox_block->getThankyouLinkUrl(); ?>"><?php echo $lightbox_block->getThankyouLinkText(); ?></a>
			</span>
			<br>
		</div>
		<div class="email-newsletter-coupon-code"><?php echo $lightbox_block->getThankyouCouponCode(); ?></div>
		<div class="email-newsletter-disclaimer"><?php echo $lightbox_block->getThankyouDisclaimerText(); ?></div>
	</div>
</div>
<script src="/js/jquery-cookie/jquery.cookie.js"></script>
<script type="text/javascript">
	//<![CDATA[
	jQuery(document).ready(function () {
		function validateEmail(email) {
			var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
			return re.test(email);
		}

		jQuery('.email-newsletter-close').click(function (event) {
			jQuery('#email-newsletter-lightbox-container').hide();
		});
		jQuery('.email-newsletter-continue').click(function (event) {
			jQuery('#email-newsletter-lightbox-container').hide();
		});
		jQuery('#email-newsletter-lightbox-container').click(function (event) {
			jQuery(this).hide();
		});
		jQuery('#email-newsletter-lightbox-thankyou').click(function (event) {
			event.stopPropagation();
		});
		jQuery('#newsletter-validate-detail-footer').submit(function (event) {
			event.preventDefault();
			var submitted_email = jQuery('input#newsletter-footer').val();
			if (validateEmail(submitted_email)) {
				jQuery.post('/newsletter/subscriber/new', jQuery('form#newsletter-validate-detail-footer').serialize());
				jQuery('#email-newsletter-lightbox-container').show();
				jQuery('input#newsletter-footer').val('');
			}
			else {
				alert('Please enter a valid email address');
			}
		});
	});
	//]]>
</script>